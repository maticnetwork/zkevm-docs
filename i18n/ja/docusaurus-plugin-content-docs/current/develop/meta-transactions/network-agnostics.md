---
id: network-agnostics
title: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯Agnosticãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³
sidebar_label: Network Agnostic Transactions
description: "ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯Agnosticãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’dAppã«çµ±åˆã—ã¾ã™ã€‚"
keywords:
  - docs
  - matic
image: https://matic.network/banners/matic-network-16x9.png
---

## ã‚´ãƒ¼ãƒ« {#goal}

Metamaskã®ãƒ—ãƒ­ãƒã‚¤ãƒ€ã‚’å¤‰æ›´ã›ãšã«ã€Polygonãƒã‚§ãƒ¼ãƒ³ã§ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ï¼ˆã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã¯ã€ãƒ¡ã‚¿ãƒã‚¹ã‚¯ã®ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ãƒ—ãƒ­ãƒã‚¤ãƒ€ã«å¯¾å¿œã—ã¦ãŠã‚Šã€ä»–ã®ãƒ—ãƒ­ãƒã‚¤ãƒ€ã‹ã‚‰ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«å¤‰æ›´ã§ãã¾ã™)ã€‚

å†…éƒ¨ã§ã¯ã€ãƒ¦ãƒ¼ã‚¶ã¯ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ã‚¤ãƒ³ãƒ†ãƒ³ãƒˆã«ç½²åã—ã¾ã™ã€‚ã“ã‚Œã¯å˜ç´”ãªãƒªãƒ¬ã‚¤ãƒ¤ãƒ¼ã«ã‚ˆã£ã¦ãƒªãƒ¬ãƒ¼ã•ã‚Œã€Polygonãƒã‚§ãƒ¼ãƒ³ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚ŒãŸã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã§å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚


## ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè¡Œã‚’æœ‰åŠ¹ã«ã™ã‚‹ã®ã¯ä½•ã§ã™ã‹ï¼Ÿ {#what-is-enabling-transaction-execution}

ãƒ¦ãƒ¼ã‚¶ãŒæ“ä½œã™ã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆï¼ˆWebãƒ–ãƒ©ã‚¦ã‚¶ã€ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªãªã©ï¼‰ã¯ã€ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã¨ã‚„ã‚Šå–ã‚Šã™ã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ä»£ã‚ã‚Šã«ã€GSNã‚„ãã®ä»–ã®ãƒ¡ã‚¿ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ©Ÿèƒ½ã™ã‚‹æ–¹æ³•ã¨åŒæ§˜ã«ã€å˜ç´”ãªãƒªãƒ¬ãƒ¼ã‚µãƒ¼ãƒãƒ¼ï¼ˆã¾ãŸã¯ãƒªãƒ¬ãƒ¼ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼‰ã¨ã‚„ã‚Šå–ã‚Šã—ã¾ã™ã€‚ï¼ˆå‚ç…§:[ï¼šã€Œãƒ¡ã‚¿ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ï¼šã¯ã˜ã‚](https://www.notion.so/Meta-Transactions-An-Introduction-8f54cf75321e4ec3b6d755e18e406590)ã«ã€)ã€‚

ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã¨ã‚„ã‚Šå–ã‚Šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®å ´åˆã€

- ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¯ãƒ¦ãƒ¼ã‚¶ã« EIP712 å½¢å¼ã®ç½²åã‚’è¦æ±‚ã™ã‚‹
- ç½²åã¯å˜ç´”ãªãƒªãƒ¬ãƒ¼ã‚µãƒ¼ãƒã«é€ä¿¡ã•ã‚Œã‚‹ (æœ¬ç•ªç’°å¢ƒã§ä½¿ç”¨ã™ã‚‹å ´åˆã¯ã€å˜ç´”ãªèªè¨¼/ã‚¹ãƒ‘ãƒ ä¿è­·ãŒå¿…è¦ã§ã™ã€‚ã¾ãŸã¯ã€ãƒã‚¤ã‚³ãƒãƒŸãƒ¼ã®mexa sdkã‚’ä½¿ç”¨å¯èƒ½ï¼š[https://github.com/bcnmy/mexa-sdk](https://github.com/bcnmy/mexa-sdk)ï¼‰
- ãƒªãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã¨ã‚„ã‚Šå–ã‚Šã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ã®ç½²åã‚’ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã«é€ä¿¡ã—ã¾ã™ã€‚`executeMetaTransaction`ã¨å‘¼ã°ã‚Œã‚‹ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®æ©Ÿèƒ½ãŒç½²åã‚’å‡¦ç†ã—ã€è¦æ±‚ã•ã‚ŒãŸãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ï¼ˆå†…éƒ¨å‘¼ã³å‡ºã—ã‚’ä»‹ã—ã¦ï¼‰å®Ÿè¡Œã—ã¾ã™ã€‚
- ãƒªãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ã‚¬ã‚¹ã®æ–™é‡‘ã‚’æ”¯æ‰•ã„ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã¯å®Ÿè³ªçš„ã«ç„¡æ–™ã«ãªã‚‹ğŸ¤‘

## ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯Agnosticãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’dAppã«çµ±åˆã™ã‚‹ {#integrate-network-agnostic-transactions-in-your-dapp}

- ã‚«ã‚¹ã‚¿ãƒ ã®ã‚·ãƒ³ãƒ—ãƒ«ãªãƒªãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒãƒ¼ãƒ‰/ãƒã‚¤ã‚³ãƒãƒŸãƒ¼ã‹ã‚‰é¸æŠã—ã¾ã™ã€‚

  - ãƒã‚¤ã‚³ãƒãƒŸãƒ¼ã«ã¤ã„ã¦ã¯ã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‹ã‚‰dappã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã€api-idã¨api-keyã‚’ä¿å­˜ã—ã¾ã™ã€‚[ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ï¼šã€Œãƒã‚¤ã‚³ãƒãƒŸãƒ¼ã€](https://www.notion.so/Tutorial-Biconomy-7f578bfb4e7d4904b8c79522085ba568)ã¾ãŸã¯[https://docs.biconomy.io/](https://docs.biconomy.io/)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

  **ã‚¹ãƒ†ãƒƒãƒ—ï¼š**

    1. ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã‚’ãƒã‚¤ã‚³ãƒãƒŸãƒ¼ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ç™»éŒ²ã—ã¾ã—ã‚‡ã†
       1. [ãƒã‚¤ã‚³ãƒãƒŸãƒ¼ã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://docs.biconomy.io/biconomy-dashboard)ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚
       2. dappã®ç™»éŒ²ä¸­ã«ã€`Polygon Mumbai`ã‚’é¸æŠã™ã‚‹
    2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ä½¿ç”¨ã™ã‚‹`API key`ã‚’ã‚³ãƒ”ãƒ¼ã™ã‚‹
    3. ãã—ã¦ã€Manage-Apiã«`executeMetaTransaction`æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã€meta-txã‚’ã‚¤ãƒãƒ¼ãƒ–ãƒ«ã«ã—ã¾ã™ã€‚(ã€Œnative-metatxã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯ã‚’ä»˜ã‘ã‚‹)

  - ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒ¼ãƒ³ã§ç½²åã•ã‚ŒãŸãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’é€ä¿¡ã™ã‚‹ç‹¬è‡ªã®ã‚«ã‚¹ã‚¿ãƒ APIã‚’ä½¿ç”¨ã—ãŸã„å ´åˆã¯ã€ã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ¼ãƒ‰ã‚’å‚ç…§ã—ã¦ãã ã•ã„ï¼š[https://github.com/angelagilhotra/ETHOnline-Workshop/tree/master/2-network-agnostic-transfer](https://github.com/angelagilhotra/ETHOnline-Workshop/tree/master/2-network-agnostic-transfer)

- ã‚„ã‚Šå–ã‚Šã—ãŸã„ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆãŒ`NativeMetaTransactions`ã‹ã‚‰ç¶™æ‰¿ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ - ğŸ‘€ ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®`executeMetaTransaction`æ©Ÿèƒ½ã‚’ã®ãã„ã¦ã¿ã¦ãã ã•ã„ã€‚
- ãƒªãƒ³ã‚¯ï¼š[https://github.com/maticnetwork/pos-portal/blob/34be03cfd227c25b49c5791ffba6a4ffc9b76036/flat/ChildERC20.sol#L1338](https://github.com/maticnetwork/pos-portal/blob/34be03cfd227c25b49c5791ffba6a4ffc9b76036/flat/ChildERC20.sol#L1338)



```jsx

let data = await web3.eth.abi.encodeFunctionCall({
    name: 'getNonce',
    type: 'function',
    inputs: [{
        name: "user",
        type: "address"
      }]
  }, [accounts[0]]);

  let _nonce = await web3.eth.call ({
    to: token["80001"],
    data
  });

  const dataToSign = getTypedData({
    name: token["name"],
    version: '1',
    salt: '0x0000000000000000000000000000000000000000000000000000000000013881',
    verifyingContract: token["80001"],
    nonce: parseInt(_nonce),
    from: accounts[0],
    functionSignature: functionSig
  });

  const msgParams = [accounts[0], JSON.stringify(dataToSign)];

  let sig = await eth.request ({
    method: 'eth_signTypedData_v3',
    params: msgParams
  });

  ```


- ãƒªãƒ¬ã‚¤ãƒ¤ãƒ¼ã¨ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ãŸã‚‰ã€ã™ã¹ãã“ã¨ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒEIP712å½¢å¼ã®ç½²åã‚’ãƒ•ã‚§ãƒƒãƒã—ã€å¿…è¦ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’æŒ‡å®šã—ã¦APIã‚’å‘¼ã³å‡ºã—ã™ã‚‹ã ã‘ã§ã™ã€‚

å‚è€ƒ[ï¼šhttps://github.com/angelagilhotra/ETHOnline-Workshop/blob/6b615b8a4ef00553c17729c721572529303c8e1b/2-network-agnostic-transfer/sign.js#L47](https://github.com/angelagilhotra/ETHOnline-Workshop/blob/6b615b8a4ef00553c17729c721572529303c8e1b/2-network-agnostic-transfer/sign.js#L47)

    ```jsx

    let data = await web3.eth.abi.encodeFunctionCall({
        name: 'getNonce',
        type: 'function',
        inputs: [{
            name: "user",
            type: "address"
          }]
      }, [accounts[0]]);

      let _nonce = await web3.eth.call ({
        to: token["80001"],
        data
      });

      const dataToSign = getTypedData({
        name: token["name"],
        version: '1',
        salt: '0x0000000000000000000000000000000000000000000000000000000000013881',
        verifyingContract: token["80001"],
        nonce: parseInt(_nonce),
        from: accounts[0],
        functionSignature: functionSig
      });
      const msgParams = [accounts[0], JSON.stringify(dataToSign)];

      let sig = await eth.request ({
        method: 'eth_signTypedData_v3',
        params: msgParams
      });
    ```

APIã‚’å‘¼ã³å‡ºã™[ï¼šhttps://github.com/angelagilhotra/ETHOnline-Workshop/blob/6b615b8a4ef00553c17729c721572529303c8e1b/2-network-agnostic-transfer/sign.js#L110](https://github.com/angelagilhotra/ETHOnline-Workshop/blob/6b615b8a4ef00553c17729c721572529303c8e1b/2-network-agnostic-transfer/sign.js#L110)

    ```jsx
    const response = await request.post(
        'http://localhost:3000/exec', {
          json: txObj,
        },
        (error, res, body) => {
          if (error) {
            console.error(error)
            return
          }
          document.getElementById(el).innerHTML =
          `response:`+ JSON.stringify(body)
        }
      )
    ```

ãƒã‚¤ã‚³ãƒãƒŸãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯ã€æ¬¡ã®ã‚ˆã†ã«å‘¼ã³å‡ºã™å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

    ```jsx
    const response = await request.post(
        'https://api.biconomy.io/api/v2/meta-tx/native', {
          json: txObj,
        },
        (error, res, body) => {
          if (error) {
            console.error(error)
            return
          }
          document.getElementById(el).innerHTML =
          `response:`+ JSON.stringify(body)
        }
      )
    ```

`txObj`ã¯ã€æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š

    ```json
    {
        "to": "0x2395d740789d8C27C139C62d1aF786c77c9a1Ef1",
        "apiId": <API ID COPIED FROM THE API PAGE>,
        "params": [
            "0x2173fdd5427c99357ba0dd5e34c964b08079a695",
            "0x2e1a7d4d000000000000000000000000000000000000000000000000000000000000000a",
            "0x42da8b5ac3f1c5c35c3eb38d639a780ec973744f11ff75b81bbf916300411602",
            "0x32bf1451a3e999b57822bc1a9b8bfdfeb0da59aa330c247e4befafa997a11de9",
            "27"
        ],
        "from": "0x2173fdd5427c99357ba0dd5e34c964b08079a695"
    }
    ```

- ã‚«ã‚¹ã‚¿ãƒ  API ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚³ãƒ³ãƒˆãƒ©ã‚¯ãƒˆä¸Šã§`executeMetaTransaction`æ©Ÿèƒ½ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

ï¼ˆå‚è€ƒ[ï¼šhttps://github.com/angelagilhotra/ETHOnline-Workshop/blob/6b615b8a4ef00553c17729c721572529303c8e1b/2-network-agnostic-transfer/server/index.js#L40ï¼‰](https://github.com/angelagilhotra/ETHOnline-Workshop/blob/6b615b8a4ef00553c17729c721572529303c8e1b/2-network-agnostic-transfer/server/index.js#L40)

    ```jsx
    try {
        let tx = await contract.methods.executeMetaTransaction(
          txDetails.from, txDetails.fnSig, r, s, v
        ).send ({
          from: user,
          gas: 800000
        })
        req.txHash = tx.transactionHash
      } catch (err) {
        console.log (err)
        next(err)
      }
    ```

ãƒã‚¤ã‚³ãƒãƒŸãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã«ã¯ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã®å‘¼ã³å‡ºã—ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š

    ```jsx
    // client/src/App.js
    import React from "react";
    import Biconomy from "@biconomy/mexa";

    const getWeb3 = new Web3(biconomy);
    biconomy
        .onEvent(biconomy.READY, () => {
          // Initialize your dapp here like getting user accounts etc
          console.log("Mexa is Ready");
        })
        .onEvent(biconomy.ERROR, (error, message) => {
          // Handle error while initializing mexa
    			console.error(error);
        });

    /**
    * use the getWeb3 object to define a contract and calling the function directly
    */

    ```
